# Define variables
$sharePointSiteUrl = "https://yourcompany.sharepoint.com/sites/yoursite"
$sharePointFolderPath = "/Shared Documents/YourFolder"
$username = "your.email@company.com"
$password = "yourpassword"

# Convert password to secure string
$securePassword = ConvertTo-SecureString $password -AsPlainText -Force
$credentials = New-Object System.Management.Automation.PSCredential($username, $securePassword)

# Create a header for basic authentication
$encodedCreds = [System.Convert]::ToBase64String([System.Text.Encoding]::ASCII.GetBytes(("$username:$password")))
$headers = @{
    Authorization = "Basic $encodedCreds"
}

# Define the full URL to the SharePoint folder
$fullUrl = "$sharePointSiteUrl/_api/web/GetFolderByServerRelativeUrl('$sharePointFolderPath')/Files"

# Send a request to SharePoint
try {
    $response = Invoke-RestMethod -Uri $fullUrl -Headers $headers -Method Get
    Write-Host "Connected to SharePoint folder."

    # Parse the response to get the file names
    $files = $response.d.results

    if ($files.Count -gt 0) {
        Write-Host "Files in the SharePoint folder:"
        $files | ForEach-Object { Write-Host $_.Name }
    } else {
        Write-Host "No files found in the SharePoint folder."
    }
} catch {
    Write-Host "Failed to connect to SharePoint folder. Error: $_"
}
