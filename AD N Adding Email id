# Define variables
$sharedDriveFolderPath = "C:\Path\To\SharedDrive\Folder"
$sharePointSiteUrl = "https://yourcompany.sharepoint.com/sites/yoursite"
$sharePointFolderPath = "/Shared Documents/YourFolder"  # Relative path within the document library
$username = "your.email@company.com"
$password = "yourpassword"

# Create a WebClient object for uploading
$webClient = New-Object System.Net.WebClient

# Set the credentials
$securePassword = ConvertTo-SecureString $password -AsPlainText -Force
$credentials = New-Object System.Management.Automation.PSCredential($username, $securePassword)
$webClient.Credentials = $credentials

# Get all files from the shared drive folder
$files = Get-ChildItem -Path $sharedDriveFolderPath

# Loop through each file and upload to SharePoint
foreach ($file in $files) {
    $filePath = $file.FullName
    $fileName = $file.Name
    $targetUrl = "$sharePointSiteUrl/$sharePointFolderPath/$fileName"

    # Upload the file to SharePoint
    $webClient.UploadFile($targetUrl, $filePath)
}

# Cleanup
$webClient.Dispose()
