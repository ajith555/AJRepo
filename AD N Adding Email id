# Define variables
$sharePointSiteUrl = "https://yourcompany.sharepoint.com/sites/yoursite"
$sharePointFolderPath = "/Shared Documents/YourFolder"  # Path within the document library
$username = "your.email@company.com"
$password = "yourpassword"

# Create a WebClient object
$webClient = New-Object System.Net.WebClient

# Set the credentials
$securePassword = ConvertTo-SecureString $password -AsPlainText -Force
$credentials = New-Object System.Management.Automation.PSCredential($username, $securePassword)
$webClient.Credentials = $credentials

# Define the full URL to the SharePoint folder
$fullUrl = "$sharePointSiteUrl/_api/web/GetFolderByServerRelativeUrl('$sharePointFolderPath')/Files"

# Send a request to SharePoint
$response = Invoke-WebRequest -Uri $fullUrl -Credential $credentials -UseBasicParsing

# Check if the request was successful
if ($response.StatusCode -eq 200) {
    Write-Host "Connected to SharePoint folder."

    # Parse the response to get the file names
    $files = ($response.Content | ConvertFrom-Json).d.results

    if ($files.Count -gt 0) {
        Write-Host "Files in the SharePoint folder:"
        $files | ForEach-Object { Write-Host $_.Name }
    } else {
        Write-Host "No files found in the SharePoint folder."
    }
} else {
    Write-Host "Failed to connect to SharePoint folder. Status Code: $($response.StatusCode)"
}
