Sub GetRepliedEmails()
    Dim objApp As Application
    Dim objNS As Namespace
    Dim objSentFolder As MAPIFolder
    Dim objItems As Items
    Dim objItem As Object ' Use Object instead of MailItem to handle various types of items
    Dim xlApp As Object
    Dim xlWorkbook As Object
    Dim xlWorksheet As Object
    Dim row As Integer
    Dim lastCheckedTime As Date
    Dim repliedTime As Date
    
    ' Define the email address to filter by
    Dim filterEmail As String
    filterEmail = "your@email.com;kushal-ajith.shetty@ubs.com"
    
    ' Define the desired time interval in hours
    Dim hoursInterval As Integer
    hoursInterval = 24 ' Change this to your desired interval
    
    ' Initialize Outlook objects
    Set objApp = Application
    Set objNS = objApp.GetNamespace("MAPI")
    Set objSentFolder = objNS.GetDefaultFolder(olFolderSentMail)
    Set objItems = objSentFolder.Items
    objItems.Sort "[ReceivedTime]", False
    row = 2 ' Start writing data from row 2 in Excel
    
    ' Initialize Excel objects
    On Error Resume Next
    Set xlApp = GetObject(, "Excel.Application")
    On Error GoTo 0
    
    ' If Excel is not open, create a new workbook
    If xlApp Is Nothing Then
        Set xlApp = CreateObject("Excel.Application")
        xlApp.Visible = True
        xlApp.Workbooks.Add
    End If
    
    ' Set the Excel workbook and worksheet
    Set xlWorkbook = xlApp.ActiveWorkbook
    Set xlWorksheet = xlWorkbook.Sheets(1)
    
    ' Find the last checked time in Excel, assuming it's in cell A1
    On Error Resume Next
    lastCheckedTime = xlWorksheet.Cells(1, 1).Value
    On Error GoTo 0
    
    ' Loop through sent items and extract data
    For Each objItem In objItems
        If objItem.Class = olMail Then
            Set objItem = objItem
            If objItem.ReceivedTime > lastCheckedTime Then
                If InStr(objItem.Subject, "RE:") = 1 Then ' Check if it's a replied email
                    If objItem.Recipients.Count > 0 Then
                        repliedTime = objItem.ReceivedTime
                        xlWorksheet.Cells(row, 1).Value = objItem.Subject
                        xlWorksheet.Cells(row, 2).Value = objItem.SenderEmailAddress
                        xlWorksheet.Cells(row, 3).Value = filterEmail
                        xlWorksheet.Cells(row, 4).Value = repliedTime
                        xlWorksheet.Cells(row, 5).Value = objItem.ReceivedTime
                        row = row + 1
                    End If
                End If
            End If
        End If
    Next objItem
    
    ' Update the last checked time in Excel
    xlWorksheet.Cells(1, 1).Value = Now
    
    ' Display the Excel file
    xlApp.Visible = True
    
    ' Clean up
    Set objApp = Nothing
    Set objNS = Nothing
    Set objSentFolder = Nothing
    Set objItems = Nothing
    Set objItem = Nothing
    Set xlApp = Nothing
    Set xlWorkbook = Nothing
    Set xlWorksheet = Nothing
End Sub
