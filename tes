Sub InternalMail(olMail As MailItem)
    Dim olApp As Outlook.Application
    Set olApp = New Outlook.Application
    
    Dim internalDomain As String
    internalDomain = "@abc.com"
    
    Dim inbox As Outlook.MAPIFolder
    Set inbox = olApp.Session.GetDefaultFolder(olFolderInbox)
    
    Dim targetFolder As Outlook.MAPIFolder
    
    If olMail.SenderEmailAddress Like "*" & internalDomain Then
        Set targetFolder = inbox.Folders("Internal Mail")
        olMail.Categories = "Internal"
    Else
        Set targetFolder = inbox.Folders("External Mail")
        olMail.Categories = "External"
    End If
    
    olMail.Move targetFolder
End Sub
