Sub ExportRepliedEmailsToExcelWithFixedHours()
    Dim objApp As Outlook.Application
    Dim objNamespace As Outlook.NameSpace
    Dim objFolder As Outlook.MAPIFolder
    Dim objItems As Outlook.Items
    Dim objMail As Outlook.MailItem
    Dim xlApp As Object
    Dim xlWorkbook As Object
    Dim xlSheet As Object
    Dim iRow As Integer
    Dim selectedAccountEmailAddress As String
    Dim hours As Double
    
    ' Define the email address of the desired account
    selectedAccountEmailAddress = "your_email@example.com" ' Replace with the desired email address
    
    ' Define the desired time frame in hours
    hours = 24 ' Replace with the desired number of hours
    
    ' Create Excel Application
    Set xlApp = CreateObject("Excel.Application")
    
    ' Connect to the specified Outlook account
    Set objApp = Outlook.Application
    Set objNamespace = objApp.GetNamespace("MAPI")
    Set objFolder = objNamespace.GetSharedDefaultFolder(objNamespace.CreateRecipient(selectedAccountEmailAddress), olFolderSentMail)
    
    ' Create a new Excel workbook and add a worksheet
    Set xlWorkbook = xlApp.Workbooks.Add
    Set xlSheet = xlWorkbook.Sheets(1)
    
    ' Add headers to Excel worksheet
    xlSheet.Cells(1, 1).Value = "Subject"
    xlSheet.Cells(1, 2).Value = "Received Time"
    xlSheet.Cells(1, 3).Value = "Response Time"
    
    ' Get the emails from the Sent Items folder
    Set objItems = objFolder.Items
    
    ' Initialize row counter
    iRow = 2
    
    ' Loop through the emails in the Sent Items folder
    For Each objMail In objItems
        If objMail.Class = olMail Then
            If objMail.ReceivedTime >= Now - hours / 24 Then
                ' Check if the email has been replied to
                If objMail.ReplyTime <> #1/1/4501# Then
                    ' Write email information to Excel
                    xlSheet.Cells(iRow, 1).Value = objMail.Subject
                    xlSheet.Cells(iRow, 2).Value = objMail.ReceivedTime
                    xlSheet.Cells(iRow, 3).Value = objMail.ReplyTime
                    iRow = iRow + 1
                End If
            End If
        End If
    Next objMail
    
    ' Save Excel workbook and display it
    xlWorkbook.SaveAs "C:\Path\To\Save\RepliedEmails.xlsx" ' Change the path as needed
    xlApp.Visible = True
    
    ' Clean up objects
    Set xlApp = Nothing
    Set objApp = Nothing
    Set objNamespace = Nothing
    Set objFolder = Nothing
    Set objItems = Nothing
    Set objMail = Nothing
    Set xlWorkbook = Nothing
    Set xlSheet = Nothing
End Sub
