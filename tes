Sub InternalMail(olMail As MailItem)
    Dim myDomain As String
    myDomain = "@abc.com"
    
    With olMail
        If Right(.SenderEmailAddress, Len(myDomain)) = myDomain Then ' Sender is internal
            If Not .CC = vbNullString Then ' There is a CC entry
                Dim ccArray() As String
                ccArray = Split(.CC, ";")
                Dim isExternalCC As Boolean
                isExternalCC = False
                
                For Each cc In ccArray
                    If Right(Trim(cc), Len(myDomain)) <> myDomain Then
                        isExternalCC = True
                        Exit For
                    End If
                Next cc
                
                If isExternalCC Then ' At least one CC is external
                    .Categories = "External"
                    .Move Session.GetDefaultFolder(olFolderInbox).Folders("External Email")
                Else ' All CCs are internal
                    .Categories = "Internal"
                    .Move Session.GetDefaultFolder(olFolderInbox).Folders("Internal Email")
                End If
            Else ' There is no CC - sender is internal
                .Categories = "Internal"
                .Move Session.GetDefaultFolder(olFolderInbox).Folders("Internal Email")
            End If
        Else ' Sender is external
            .Categories = "External"
            .Move Session.GetDefaultFolder(olFolderInbox).Folders("External Email")
        End If
    End With
End Sub
