Sub FetchRepliedEmailsFromSentItems()
    Dim objOutlook As Object
    Dim objNamespace As Object
    Dim objSentItemsFolder As Object
    Dim objMailItem As Object
    Dim objItems As Object
    Dim startTime As Date
    Dim filter As String
    
    ' Define the number of hours to go back
    Dim hoursToGoBack As Integer
    hoursToGoBack = 24 ' Change this to your desired number of hours
    
    ' Calculate the start time
    startTime = Now - TimeSerial(hoursToGoBack, 0, 0)
    
    ' Create the Outlook application and namespace
    Set objOutlook = CreateObject("Outlook.Application")
    Set objNamespace = objOutlook.GetNamespace("MAPI")
    
    ' Get the "Sent Items" folder
    Set objSentItemsFolder = objNamespace.GetDefaultFolder(5) ' 5 represents the Sent Items folder
    
    ' Define the filter to retrieve replied emails from the specified time
    filter = "[ReceivedTime] >= '" & Format(startTime, "yyyy-mm-dd hh:mm AMPM") & "' AND [MessageClass] = 'IPM.Note.SMIME.MultipartSigned'"
    
    ' Get the items that match the filter
    Set objItems = objSentItemsFolder.Items.Restrict(filter)
    
    ' Loop through the filtered items (replied emails)
    For Each objMailItem In objItems
        Debug.Print "Subject: " & objMailItem.Subject
        Debug.Print "Received Time: " & objMailItem.ReceivedTime
        Debug.Print "Sender: " & objMailItem.SenderName
        ' You can add more actions here as needed
    Next objMailItem
    
    ' Clean up objects
    Set objOutlook = Nothing
    Set objNamespace = Nothing
    Set objSentItemsFolder = Nothing
    Set objItems = Nothing
    Set objMailItem = Nothing
End Sub
