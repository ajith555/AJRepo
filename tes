Sub MoveExternalEmails()
    Dim myDomain As String
    myDomain = "@abc.com"
    
    Dim olApp As Object
    Set olApp = CreateObject("Outlook.Application")
    
    Dim olNamespace As Object
    Set olNamespace = olApp.GetNamespace("MAPI")
    
    Dim inboxFolder As Object
    Set inboxFolder = olNamespace.GetDefaultFolder(6) ' Inbox folder
    
    Dim externalEmailFolder As Object
    On Error Resume Next
    Set externalEmailFolder = inboxFolder.Folders("External Email")
    On Error GoTo 0
    
    If externalEmailFolder Is Nothing Then
        Set externalEmailFolder = inboxFolder.Folders.Add("External Email")
    End If
    
    ProcessFolder inboxFolder, externalEmailFolder, myDomain
    
    MsgBox "External emails moved to the 'External Email' folder.", vbInformation
End Sub

Sub ProcessFolder(currentFolder As Object, externalFolder As Object, myDomain As String)
    Dim item As Object
    Dim i As Integer
    
    For i = currentFolder.Items.Count To 1 Step -1
        Set item = currentFolder.Items(i)
        
        If item.Class = olMail And Right(item.SenderEmailAddress, Len(myDomain)) <> myDomain Then
            item.Move externalFolder
        End If
    Next i
    
    If currentFolder.Folders.Count > 0 Then
        Dim subFolder As Object
        For Each subFolder In currentFolder.Folders
            ProcessFolder subFolder, externalFolder, myDomain
        Next subFolder
    End If
End Sub
