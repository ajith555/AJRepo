# Prompt the user for credentials
$credential = Get-Credential

# Define the base URL
$baseUrl = "https://ubs.invisionapp.com"

# Fetch the content of the website with authentication
$response = Invoke-WebRequest -Uri "$baseUrl" -UseBasicParsing -Credential $credential

# Extract the URLs
$urls = $response.ParsedHtml.getElementsByTagName("a") | ForEach-Object {
    # Check if the href attribute contains the required pattern
    if ($_.href -match "/overview/.*/exports/initiate/pdf\?method=overviewMenu&sortBy=1&sortOrder=1&ViewLayout=2") {
        # Output the matched URL
        $_.href
    }
}

# Output the URLs
$urls




# Define the URL
$url = "https://ubs.invisionapp.com"

# Prompt the user for credentials
$credential = Get-Credential

# Make the request with Kerberos authentication
$response = Invoke-WebRequest -Uri $url -Credential $credential -Authentication Negotiate

# Extract the content or perform further actions
$response.Content


$response = Invoke-WebRequest -Uri $url -Credential $credential -Authentication NTLM
