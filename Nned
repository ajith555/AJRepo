Dim objExcelApplication As Object ' Use Object type to late-bind Excel
Dim objExcelWorkbook As Object
Dim objExcelWorksheet As Object
Dim objInbox As Outlook.Folder

Sub ExportEmailsNotReplied()
    ' Initialize Outlook objects
    Set objInbox = Application.Session.GetDefaultFolder(olFolderInbox)
    
    ' Create the "(1) AGED Internal" folder if it doesn't exist
    Dim objAgedInternalFolder As Outlook.Folder
    On Error Resume Next
    Set objAgedInternalFolder = objInbox.Folders("(1) AGED Internal")
    On Error GoTo 0
    
    If objAgedInternalFolder Is Nothing Then
        Set objAgedInternalFolder = objInbox.Folders.Add("(1) AGED Internal")
    End If

    ' Process folders and emails
    Call ProcessFolderItems(objInbox, objAgedInternalFolder)
End Sub

Sub ProcessFolderItems(ByVal objCurrentFolder As Outlook.Folder, ByVal objAgedInternalFolder As Outlook.Folder)
    Dim objItems As Outlook.Items
    Dim objMail As Outlook.MailItem
    Dim strReplied As String
    Dim nDateDiff As Integer

    Set objItems = objCurrentFolder.Items
    
    For Each objMail In objItems
        If objMail.Class = olMail Then
            strReplied = objMail.PropertyAccessor.GetProperty("http://schemas.microsoft.com/mapi/proptag/0x10810003")
            
            ' Calculate the time difference in hours (48 hours = 2 days)
            nDateDiff = DateDiff("h", objMail.ReceivedTime, Now)
            
            If (Not (strReplied = "102")) And (Not (strReplied = "103")) And (nDateDiff <= 48) Then
                ' Move the email to the "(1) AGED Internal" folder
                objMail.Move objAgedInternalFolder
            End If
        End If
    Next objMail
End Sub
