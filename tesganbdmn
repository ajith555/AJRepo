# Import the Selenium WebDriver module
Import-Module Selenium.WebDriver

# Set the path to the ChromeDriver executable
$driverPath = "C:\path\to\chromedriver.exe"

# Create a ChromeOptions object to configure the browser
$options = New-Object OpenQA.Selenium.Chrome.ChromeOptions

# Set the options to run the browser in GUI mode
$options.AddArgument("start-maximized")
$options.AddArgument("disable-infobars")
$options.AddArgument("disable-extensions")

# Create a ChromeDriver object and start the browser
$driver = New-Object OpenQA.Selenium.Chrome.ChromeDriver($driverPath, $options)

# Navigate to the website
$url = "https://www.example.com"
$driver.Navigate().GoToUrl($url)

# Get the cookies and JSESSIONID
$cookies = $driver.Manage().Cookies.AllCookies
$jsessionid = $cookies | Where-Object { $_.Name -eq "JSESSIONID" }

# Print the cookies and JSESSIONID
Write-Output "Cookies:"
$cookies | ForEach-Object { Write-Output "- $($_.Name): $($_.Value)" }
Write-Output "JSESSIONID: $($jsessionid.Value)"

# Quit the browser
$driver.Quit()
