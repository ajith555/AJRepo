# Install Selenium and EPPlus if not already installed
Install-Package Selenium.WebDriver -Force
Install-Package EPPlus -Force

# Import required namespaces
Add-Type -Path "path\to\Selenium.WebDriver.dll"
Add-Type -Path "path\to\WebDriver.Support.dll"
Add-Type -Path "path\to\EPPlus.dll"

# Set up the Chrome driver
$chromeDriverPath = "path\to\chromedriver.exe"
$chromeOptions = New-Object OpenQA.Selenium.Chrome.ChromeOptions
$chromeOptions.AddArguments("--headless") # Run Chrome headlessly to avoid opening a visible browser window
$driver = New-Object OpenQA.Selenium.Chrome.ChromeDriver($chromeDriverPath, $chromeOptions)

# Navigate to the website
$driver.Navigate().GoToUrl("https://www.example.com")

# Define the xpath links to fetch data
$xpathLinks = @(
    "//div[@class='class1']",
    "//div[@class='class2']",
    "//div[@class='class3']"
)

# Fetch the data and put it in a list
$data = foreach ($xpath in $xpathLinks) {
    $element = $driver.FindElementByXPath($xpath)
    $element.Text
}

# Create a new Excel workbook and worksheet
$excelPath = "path\to\output.xlsx"
$excelPackage = New-Object OfficeOpenXml.ExcelPackage(New-Item -Path $excelPath -ItemType File)
$worksheet = $excelPackage.Workbook.Worksheets.Add("Sheet1")

# Write the data to the worksheet
$rowIndex = 1
foreach ($datum in $data) {
    $worksheet.Cells.Item($rowIndex, 1).Value = $datum
    $rowIndex++
}

# Save the workbook and close the driver
$excelPackage.Save()
$driver.Close()
