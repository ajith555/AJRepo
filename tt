Option Explicit

Dim objOutlook, objNamespace, objFolder, objItems, objAttachment, objFSO
Dim strFolderPath, strOutputFolder, strAttachmentPath

' Outlook Folder Path
strFolderPath = "Your Folder Path" ' Replace with the actual folder path in Outlook

' Output Folder Path
strOutputFolder = "Path to save attachments" ' Replace with the desired output folder path

' Create Outlook Application Object
Set objOutlook = CreateObject("Outlook.Application")
Set objNamespace = objOutlook.GetNamespace("MAPI")

' Get the Outlook Folder
Set objFolder = objNamespace.GetDefaultFolder(6).Folders(strFolderPath) ' 6 corresponds to the Inbox folder

' Loop through the Items in the Folder
For Each objItems In objFolder.Items
    If objItems.Attachments.Count > 0 Then
        ' Loop through Attachments in the Email
        For Each objAttachment In objItems.Attachments
            ' Save Attachment to Output Folder
            strAttachmentPath = strOutputFolder & "\" & objAttachment.FileName
            objAttachment.SaveAsFile strAttachmentPath
        Next
    End If
Next

' Release Objects
Set objAttachment = Nothing
Set objItems = Nothing
Set objFolder = Nothing
Set objNamespace = Nothing
Set objOutlook = Nothing

' Show Completion Message
MsgBox "Email attachments downloaded successfully!", vbInformation

' Open the Output Folder
Set objFSO = CreateObject("Scripting.FileSystemObject")
objFSO.OpenFolder strOutputFolder
Set objFSO = Nothing
