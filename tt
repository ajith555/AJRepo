import os
import zipfile

# Set the file location containing emails
file_location = 'path/to/emails.txt'

# Set the save location for attachments
save_location = 'path/to/save/location/'

# Read the emails from the file location
with open(file_location, 'r') as file:
    emails = file.read().splitlines()

# Process each email
for email in emails:
    # Assuming each line contains email subject and attachment information separated by a delimiter
    subject, attachment_name, attachment_path = email.split('|')

    # Check if the subject matches 'abcd'
    if subject == 'abcd':
        # Check if the attachment is a zip file and unzip it
        if attachment_path.endswith('.zip'):
            unzip_location = os.path.join(save_location, attachment_name.split('.')[0])
            os.makedirs(unzip_location, exist_ok=True)  # Create the unzip location path if it doesn't exist
            with zipfile.ZipFile(attachment_path, 'r') as zip_ref:
                zip_ref.extractall(unzip_location)

            print(f"Unzipped attachment: {attachment_name}")
        else:
            print(f"Attachment is not a zip file: {attachment_name}")

        # Move the attachment to the final save location
        os.makedirs(save_location, exist_ok=True)  # Create the save location path if it doesn't exist
        final_path = os.path.join(save_location, attachment_name)
        os.rename(attachment_path, final_path)

        print(f"Saved attachment: {attachment_name}")

