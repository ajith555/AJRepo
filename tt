import pyodc

# Set up the Outlook 365 credentials
credentials = {
    "username": "Your_Email_Address",
    "password": "Your_Password"
}

# Set the folder name and subject of the emails you want to retrieve
folder_name = "Folder_Name"
subject = "abc"

# Set the path to save the email
save_path = "Your_Desired_Save_Path"

# Connect to Outlook 365
outlook = pyodc.Outlook()
outlook.authenticate(**credentials)

# Get the specified folder
folder = outlook.get_folder_by_name(folder_name)

# Retrieve emails with the specified subject
emails = folder.get_items(subject=subject, order_by="-ReceivedTime", top=1)

if len(emails) > 0:
    # Get the latest email
    email = emails[0]

    # Save the email as an .msg file
    email.save_as_file(save_path)

    print("Latest email saved successfully.")
else:
    print("No email found with the specified subject.")

# Disconnect from Outlook 365
outlook.disconnect()
