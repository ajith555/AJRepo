# Set the user's account
$userAccount = "<User Account>"

# Connect to Active Directory
Import-Module ActiveDirectory

# Retrieve the user object from Active Directory
$user = Get-ADUser -Filter {samAccountName -eq $userAccount} -Properties samAccountName, userPrincipalName, memberOf

if ($user) {
    # Get the user's samAccountName and userPrincipalName
    $samAccountName = $user.samAccountName
    $userPrincipalName = $user.userPrincipalName

    # Initialize an array to store the application names
    $applications = @()

    # Iterate through the user's groups
    foreach ($group in $user.memberOf) {
        # Extract the group name from the distinguishedName
        $groupName = ($group -split ",")[0] -replace "CN="

        # Check if the group name corresponds to an application
        if ($groupName -like "CN=*ApplicationName*") {
            # Extract the application name from the group name
            $applicationName = $groupName -replace "CN="

            # Add the application name to the array
            $applications += $applicationName
        }
    }

    # Output the user account, userPrincipalName, and application names
    Write-Host "User Account: $samAccountName"
    Write-Host "User Principal Name: $userPrincipalName"
    Write-Host "Applications:"
    $applications
} else {
    Write-Host "User not found."
}
