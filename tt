import os
import zipfile
import win32com.client

def unzip_attachments(mail_item, save_path):
    attachments = mail_item.Attachments
    for attachment in attachments:
        if attachment.FileName.endswith('.zip'):
            zip_path = os.path.join(save_path, attachment.FileName)
            attachment.SaveAsFile(zip_path)

            with zipfile.ZipFile(zip_path, 'r') as zip_ref:
                zip_ref.extractall(save_path)

            os.remove(zip_path)

def main():
    outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")
    inbox = outlook.GetDefaultFolder(6)  # 6 corresponds to the Inbox folder

    # Set the subject of the emails you want to retrieve
    subject = "Your desired subject"

    # Set the path to save the attachments
    save_path = "Your desired save path"

    # Loop through the inbox items
    for item in inbox.Items:
        if item.Subject == subject:
            unzip_attachments(item, save_path)

if __name__ == '__main__':
    main()
