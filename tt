# Load the Selenium WebDriver module
Import-Module Selenium.WebDriver

# Set the Chrome driver path
$ChromeDriverPath = "C:\path\to\chromedriver.exe"

# Create a Chrome driver instance
$ChromeOptions = New-Object OpenQA.Selenium.Chrome.ChromeOptions
$ChromeOptions.AddArguments("--disable-extensions")
$ChromeOptions.AddArguments("--disable-infobars")
$ChromeOptions.AddArguments("--disable-popup-blocking")
$ChromeOptions.AddArguments("--start-maximized")
$ChromeDriver = New-Object OpenQA.Selenium.Chrome.ChromeDriver($ChromeDriverPath, $ChromeOptions)

# Navigate to the main URL
$MainUrl = "http://example.com"
$ChromeDriver.Navigate().GoToUrl($MainUrl)

# Get the main URL cookies
$MainUrlCookies = $ChromeDriver.Manage().Cookies.AllCookies

# Get all child URLs
$ChildUrls = $ChromeDriver.FindElementsByTagName("a") | Where-Object { $_.GetAttribute("href") -match "^http(s)?://example.com/" }

# Loop through each child URL and get the cookies
foreach ($ChildUrl in $ChildUrls) {
    $ChromeDriver.Navigate().GoToUrl($ChildUrl.GetAttribute("href"))
    $ChildUrlCookies = $ChromeDriver.Manage().Cookies.AllCookies
    foreach ($Cookie in $ChildUrlCookies) {
        Write-Host "$($Cookie.Name) = $($Cookie.Value)"
    }
}

# Quit the Chrome driver instance
$ChromeDriver.Quit()
