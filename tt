Additionally, I have attempted to address this matter at the Hyderabad office; however, they advised me to reach out to the Pune office. Considering the circumstances, I would greatly appreciate your team's assistance in transferring or replacing the device here in Hyderabad.



Install-Module -Name ImportExcel


# Install required module if not already installed
Install-Module -Name ImportExcel

# Set API endpoint URL
$apiUrl = 'your_api_url'

# Set API key and Cookie
$apiKey = 'your_api_key'
$cookie = 'your_cookie'

# Set headers
$headers = @{
    'x-api-key' = $apiKey
    'Cookie' = $cookie
}

# Invoke API request and receive HTML response
$response = Invoke-RestMethod -Uri $apiUrl -Headers $headers

# Convert HTML response to a string
$htmlData = $response.ToString()

# Create an Excel workbook
$workbook = New-Object -TypeName OfficeOpenXml.ExcelPackage

# Create a worksheet within the workbook
$worksheet = $workbook.Workbook.Worksheets.Add('TableData')

# Parse HTML response using regular expressions
$tableData = [regex]::Matches($htmlData, '<td>(.*?)</td>').Groups[1].Value

# Split table data into rows
$rows = $tableData -split '</tr>'

# Remove empty rows
$rows = $rows | Where-Object { $_ -ne '' }

# Iterate through rows and split into cells
$rowIndex = 1
foreach ($row in $rows) {
    $cells = $row -split '</td>'
    $cellIndex = 1
    foreach ($cell in $cells) {
        $cellData = ($cell -replace '<.*?>', '').Trim()
        $worksheet.Cells.Item($rowIndex, $cellIndex).Value = $cellData
        $cellIndex++
    }
    $rowIndex++
}

# Save the Excel workbook
$workbook.SaveAs('TableData.xlsx')

# Close the workbook
$workbook.Dispose()
