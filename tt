# Import the COM object for Excel
$excel = New-Object -ComObject Excel.Application

# Set up the Chrome driver
$chromeDriverPath = "path\to\chromedriver.exe"
$chromeOptions = New-Object OpenQA.Selenium.Chrome.ChromeOptions
$chromeOptions.AddArguments("--headless") # Run Chrome headlessly to avoid opening a visible browser window
$driver = New-Object OpenQA.Selenium.Chrome.ChromeDriver($chromeDriverPath, $chromeOptions)

# Navigate to the website
$driver.Navigate().GoToUrl("https://www.example.com")

# Define the xpath links to fetch data
$xpathLinks = @(
    "//div[@class='class1']",
    "//div[@class='class2']",
    "//div[@class='class3']"
)

# Fetch the data and put it in an array
$data = foreach ($xpath in $xpathLinks) {
    $element = $driver.FindElementByXPath($xpath)
    $element.Text
}

# Create a new Excel workbook and worksheet
$excel.Visible = $false
$workbook = $excel.Workbooks.Add()
$worksheet = $workbook.Worksheets.Item(1)

# Write the data to the worksheet
$rowIndex = 1
foreach ($datum in $data) {
    $worksheet.Cells.Item($rowIndex, 1).Value2 = $datum
    $rowIndex++
}

# Save the workbook, close it, and quit Excel
$workbook.SaveAs("path\to\output.xlsx")
$workbook.Close($false)
$excel.Quit()
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($excel) | Out-Null

# Close the driver
$driver.Close()
