Sub MoveExternalEmails()
    Dim olApp As Object
    Dim olNamespace As Object
    Dim olInbox As Object
    Dim internalFolder As Object
    Dim externalFolder As Object
    Dim item As Object
    Dim recipient As Object
    Dim isExternal As Boolean
    
    ' Set up Outlook objects
    Set olApp = CreateObject("Outlook.Application")
    Set olNamespace = olApp.GetNamespace("MAPI")
    Set olInbox = olNamespace.GetDefaultFolder(6) ' Inbox folder
    
    ' Set internal and external folders
    Set internalFolder = olInbox.Folders("(1) AGED Internal")
    Set externalFolder = olInbox.Folders("(1) AGED External")
    
    ' Loop through emails in internal folder
    For Each item In internalFolder.Items
        isExternal = True ' Assume email is external
        
        ' Check recipients' email addresses
        For Each recipient In item.Recipients
            If InStr(recipient.Address, "@ubs.com") > 0 Then
                isExternal = False ' Found an internal recipient
                Exit For
            End If
        Next recipient
        
        ' Move external emails to external folder
        If isExternal Then
            item.Move externalFolder
        End If
    Next item
    
    ' Clean up
    Set recipient = Nothing
    Set item = Nothing
    Set internalFolder = Nothing
    Set externalFolder = Nothing
    Set olInbox = Nothing
    Set olNamespace = Nothing
    Set olApp = Nothing
End Sub
