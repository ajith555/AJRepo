Sub MoveExternalEmails()

    Dim olApp As Object
    Dim olNamespace As Object
    Dim olInbox As Object
    Dim olAgedInternalFolder As Object
    Dim olAgedExternalFolder As Object
    Dim olItem As Object
    Dim i As Integer
    
    Set olApp = CreateObject("Outlook.Application")
    Set olNamespace = olApp.GetNamespace("MAPI")
    Set olInbox = olNamespace.GetDefaultFolder(6) ' Inbox Folder (6)
    Set olAgedInternalFolder = olInbox.Folders("(1) AGED Internal")
    Set olAgedExternalFolder = olInbox.Folders("(1) AGED External")
    
    For i = olAgedInternalFolder.Items.Count To 1 Step -1
        Set olItem = olAgedInternalFolder.Items(i)
        If olItem.Class = 43 Then ' MailItem Class
            If Not olItem.SenderEmailType = "EX" Then
                ' Check if sender's domain is ubs.com (internal)
                If Right(olItem.SenderEmailAddress, 7) <> "ubs.com" Then
                    olItem.Move olAgedExternalFolder
                End If
            End If
        End If
    Next i
    
    Set olItem = Nothing
    Set olAgedExternalFolder = Nothing
    Set olAgedInternalFolder = Nothing
    Set olInbox = Nothing
    Set olNamespace = Nothing
    Set olApp = Nothing
    
End Sub
