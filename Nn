Sub MoveUnrepliedEmails()
    Dim OutlookApp As Object
    Dim Namespace As Object
    Dim Accounts As Object
    Dim Account As Object
    Dim Inbox As Object
    Dim Subfolder As Object
    Dim AgeLimit As Date
    Dim DestFolder As Object
    Dim DestFolderPath As String
    Dim EmailAddresses() As String
    Dim i As Integer
    
    ' Calculate the age limit (72 hours ago)
    AgeLimit = DateAdd("h", -72, Now)
    
    ' Define the destination folder path
    DestFolderPath = "(1) AGED Internal"
    
    ' Define the email addresses for the accounts you want to process
    EmailAddresses = Split("abc@abc.com,xyz@xyz.com", ",")
    
    ' Create or get the Outlook Application
    On Error Resume Next
    Set OutlookApp = GetObject(, "Outlook.Application")
    On Error GoTo 0
    
    ' If Outlook is not open, create a new instance
    If OutlookApp Is Nothing Then
        Set OutlookApp = CreateObject("Outlook.Application")
    End If
    
    ' Set the namespace and accounts
    Set Namespace = OutlookApp.GetNamespace("MAPI")
    Set Accounts = Namespace.Accounts
    
    ' Loop through the specified email accounts
    For i = LBound(EmailAddresses) To UBound(EmailAddresses)
        ' Get the account based on the email address
        Set Account = GetAccountByEmail(Accounts, EmailAddresses(i))
        
        If Not Account Is Nothing Then
            ' Get the Inbox folder for the current account
            Set Inbox = Namespace.GetFolder("Inbox").Folders(Account.DeliveryStore.DisplayName)
            
            ' Check if the destination folder exists, create it if not
            On Error Resume Next
            Set DestFolder = Inbox.Folders(DestFolderPath)
            On Error GoTo 0
            
            If DestFolder Is Nothing Then
                Set DestFolder = Inbox.Folders.Add(DestFolderPath)
            End If
            
            ' Loop through all emails in Inbox and its subfolders
            For Each Subfolder In Inbox.Folders
                ProcessFolder Subfolder, AgeLimit, DestFolder
            Next Subfolder
        End If
    Next i
    
    ' Clean up objects
    Set DestFolder = Nothing
    Set Inbox = Nothing
    Set Namespace = Nothing
    Set OutlookApp = Nothing
End Sub

Function GetAccountByEmail(Accounts As Object, EmailAddress As String) As Object
    Dim Account As Object
    For Each Account In Accounts
        If Account.SmtpAddress = EmailAddress Then
            Set GetAccountByEmail = Account
            Exit Function
        End If
    Next Account
End Function

Sub ProcessFolder(ByVal CurrentFolder As Object, ByVal AgeLimit As Date, ByVal DestFolder As Object)
    Dim Item As Object
    
    For Each Item In CurrentFolder.Items
        If Item.Class = olMail Then
            ' Check if the email is received in the past 72 hours
            If Item.ReceivedTime >= AgeLimit Then
                ' Check if the email has been replied to
                If Not Item.IsReplied Then
                    Item.Move DestFolder
                End If
            End If
        End If
    Next Item
    
    ' Recursively process subfolders
    If CurrentFolder.Folders.Count > 0 Then
        Dim Subfolder As Object
        For Each Subfolder In CurrentFolder.Folders
            ProcessFolder Subfolder, AgeLimit, DestFolder
        Next Subfolder
    End If
End Sub
