Dim objNamespace As Outlook.NameSpace
Dim objInbox As Outlook.Folder
Dim objDestFolder As Outlook.Folder

Sub CopyEmailsToAgedFolder()
    ' Initialize Outlook objects
    Set objNamespace = Application.GetNamespace("MAPI")
    Set objInbox = objNamespace.GetDefaultFolder(olFolderInbox)
    
    ' Specify the destination folder name
    Dim destFolderName As String
    destFolderName = "(1) AGED Internal"
    
    ' Check if the destination folder exists, and create it if not
    On Error Resume Next
    Set objDestFolder = objInbox.Folders(destFolderName)
    On Error GoTo 0
    
    If objDestFolder Is Nothing Then
        ' The folder doesn't exist, so create it
        Set objDestFolder = objInbox.Folders.Add(destFolderName)
    End If

    ' Process folders and copy emails
    ProcessFolders objInbox, objDestFolder
End Sub

Sub ProcessFolders(ByVal objCurrentFolder As Outlook.Folder, ByVal objDestFolder As Outlook.Folder)
    Dim objMail As Outlook.MailItem
    Dim strReplied As String
    Dim nDateDiff As Long

    For Each objMail In objCurrentFolder.Items
        If objMail.Class = olMail Then
            strReplied = objMail.PropertyAccessor.GetProperty("http://schemas.microsoft.com/mapi/proptag/0x10810003")
            
            ' Calculate the time difference in hours (48 hours = 2 days)
            nDateDiff = DateDiff("h", objMail.ReceivedTime, Now)
            
            If (strReplied <> "102" And strReplied <> "103") And (nDateDiff <= 48) Then
                ' Copy the email by creating a new item in the destination folder
                Dim copiedMail As Outlook.MailItem
                Set copiedMail = objMail.Copy
                copiedMail.Move objDestFolder
            End If
        End If
    Next objMail

    ' Recursively process subfolders
    Dim objSubfolder As Outlook.Folder
    For Each objSubfolder In objCurrentFolder.Folders
        ProcessFolders objSubfolder, objDestFolder
    Next objSubfolder
End Sub
