Sub MoveUnrepliedEmails()
    Dim OutlookApp As Object
    Dim Namespace As Object
    Dim Accounts As Object
    Dim Account As Object
    Dim Inbox As Object
    Dim Subfolder As Object
    Dim AgeLimit As Date
    Dim DestFolder As Object
    Dim DestFolderPath As String
    Dim EmailAddress As String
    
    ' Set the age limit (72 hours ago)
    AgeLimit = Now - TimeValue("72:00:00")
    
    ' Define the destination folder path
    DestFolderPath = "(1) AGED Internal"
    
    ' Define the email addresses for the accounts you want to process
    Dim EmailAddresses() As String
    EmailAddresses = Split("abc@abc.com,xyz@xyz.com", ",")
    
    ' Create or get the Outlook Application
    On Error Resume Next
    Set OutlookApp = GetObject(, "Outlook.Application")
    On Error GoTo 0
    
    ' If Outlook is not open, create a new instance
    If OutlookApp Is Nothing Then
        Set OutlookApp = CreateObject("Outlook.Application")
    End If
    
    ' Set the namespace and accounts
    Set Namespace = OutlookApp.GetNamespace("MAPI")
    Set Accounts = Namespace.Accounts
    
    ' Loop through the specified email accounts
    For Each EmailAddress In EmailAddresses
        ' Get the inbox for the current account
        Set Account = Accounts.Item(EmailAddress)
        Set Inbox = Account.DeliveryStore.GetDefaultFolder(olFolderInbox)
        
        ' Check if the destination folder exists, create it if not
        On Error Resume Next
        Set DestFolder = Inbox.Folders(DestFolderPath)
        On Error GoTo 0
        
        If DestFolder Is Nothing Then
            Set DestFolder = Inbox.Folders.Add(DestFolderPath)
        End If
        
        ' Loop through all emails in Inbox and its subfolders
        For Each Subfolder In Inbox.Folders
            ProcessFolder Subfolder, AgeLimit, DestFolder
        Next Subfolder
    Next EmailAddress
    
    ' Clean up objects
    Set DestFolder = Nothing
    Set Inbox = Nothing
    Set Namespace = Nothing
    Set OutlookApp = Nothing
End Sub

Sub ProcessFolder(ByVal CurrentFolder As Object, ByVal AgeLimit As Date, ByVal DestFolder As Object)
    Dim Item As Object
    
    For Each Item In CurrentFolder.Items
        If Item.Class = olMail Then
            If Item.ReceivedTime >= AgeLimit And Item.ReceivedTime < AgeLimit - TimeValue("48:00:00") And Not Item.ReplyTime >= AgeLimit Then
                Item.Move DestFolder
            End If
        End If
    Next Item
    
    ' Recursively process subfolders
    If CurrentFolder.Folders.Count > 0 Then
        Dim Subfolder As Object
        For Each Subfolder In CurrentFolder.Folders
            ProcessFolder Subfolder, AgeLimit, DestFolder
        Next Subfolder
    End If
End Sub
