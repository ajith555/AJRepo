# Install Selenium module
Install-Module -Name Selenium -Force -AllowClobber

# Define the URL of the website
$url = "https://example.com"

# Specify the folder where you want to save the downloaded PDFs
$downloadFolder = "C:\Path\To\Your\Folder"

# Create the folder if it doesn't exist
if (-not (Test-Path -Path $downloadFolder -PathType Container)) {
    New-Item -Path $downloadFolder -ItemType Directory
}

# Start a new Selenium WebDriver session
$webDriver = Start-SeWebDriver -Browser Chrome

# Navigate to the website
$webDriver.Navigate().GoToUrl($url)

# Find all links on the page
$links = $webDriver.FindElementsByTagname("a")

# Iterate through each link and download PDF files
foreach ($link in $links) {
    $href = $link.GetAttribute("href")

    if ($href -match '\.pdf$') {
        $pdfFileName = [System.IO.Path]::GetFileName($href)
        $pdfFilePath = Join-Path -Path $downloadFolder -ChildPath $pdfFileName

        Write-Host "Downloading $pdfFileName..."
        
        # Download PDF file using Invoke-WebRequest
        Invoke-WebRequest -Uri $href -OutFile $pdfFilePath

        Write-Host "Downloaded to $pdfFilePath"
    }
}

# Close the WebDriver session
Stop-SeWebDriver -WebDriver $webDriver
