Dim objexcelApplication As Excel.Application
Dim objexcelworkbook As Excel.Workbook
Dim objexcelworksheet As Excel.Worksheet

Const MY_CUSTOM_PROPERTY_NAME As String = "MyCustomProperty"

Sub ExportEmailsNotReplied()
    ' ... (existing code)

    ' Access the shared mailbox as a separate account
    Dim objNamespace As Outlook.Namespace
    Dim objSession As Outlook.NameSpace
    Dim objSharedMailbox As Outlook.Folder
    
    Set objNamespace = Application.GetNamespace("MAPI")
    ' Replace "shared.mailbox@example.com" with the email address of the shared mailbox.
    Set objSession = objNamespace.Session.Accounts.Item("shared.mailbox@example.com").DeliveryStore.GetStore
    Set objSharedMailbox = objSession.GetDefaultFolder(olFolderInbox)
    
    Call ProcessFolders(objSharedMailbox)
    
    ' ... (existing code)
End Sub

Sub ProcessFolders(ByVal objcurrentFolder As Outlook.Folder)
    ' ... (existing code)
    
    For i = objcurrentFolder.Items.Count To 1 Step -1
        If objcurrentFolder.Items(i).Class = olMail Then
            Set objMail = objcurrentFolder.Items(i)
            ' Set the custom property "MyCustomProperty" to "True" when the email is replied to.
            If objMail.IsMarkedAsTask Then
                SetCustomProperty objMail, MY_CUSTOM_PROPERTY_NAME, True
            End If
        End If
    Next

    ' ... (existing code)
End Sub

Sub SetCustomProperty(ByVal objItem As Object, ByVal propertyName As String, ByVal propertyValue As Variant)
    On Error Resume Next
    objItem.UserProperties.Add propertyName, olYesNo, True, olHidden
    objItem.UserProperties(propertyName).Value = propertyValue
    objItem.Save
    On Error GoTo 0
End Sub
