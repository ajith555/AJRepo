Sub ExportOutlookRules()
    Dim rules As Outlook.Rules
    Dim rule As Outlook.Rule
    Dim exportFilePath As String
    
    ' Set the export file path
    exportFilePath = "C:\Path\To\Export\Rules"
    
    ' Get the Rules object
    Set rules = Application.Session.DefaultStore.GetRules
    
    ' Export rules to CSV
    ExportRulesToCSV rules, exportFilePath & ".csv"
    
    ' Export rules to TXT
    ExportRulesToTXT rules, exportFilePath & ".txt"
    
    MsgBox "Rules exported successfully!", vbInformation
End Sub

Sub ExportRulesToCSV(rules As Outlook.Rules, filePath As String)
    Dim rule As Outlook.Rule
    Dim fileNumber As Integer
    
    ' Open a text file for writing
    fileNumber = FreeFile
    Open filePath For Output As fileNumber
    
    ' Write header to CSV file
    Print #fileNumber, "Rule Name, Conditions, Actions"
    
    ' Loop through each rule and write to CSV file
    For Each rule In rules
        Print #fileNumber, """" & rule.Name & """,""" & GetRuleConditions(rule) & """,""" & GetRuleActions(rule) & """"
    Next rule
    
    ' Close the file
    Close fileNumber
End Sub

Sub ExportRulesToTXT(rules As Outlook.Rules, filePath As String)
    Dim rule As Outlook.Rule
    Dim fileNumber As Integer
    
    ' Open a text file for writing
    fileNumber = FreeFile
    Open filePath For Output As fileNumber
    
    ' Loop through each rule and write to TXT file
    For Each rule In rules
        Print #fileNumber, "Rule Name: " & rule.Name
        Print #fileNumber, "Conditions: " & GetRuleConditions(rule)
        Print #fileNumber, "Actions: " & GetRuleActions(rule)
        Print #fileNumber, vbCrLf
    Next rule
    
    ' Close the file
    Close fileNumber
End Sub

Function GetRuleConditions(rule As Outlook.Rule) As String
    Dim condition As String
    condition = ""
    
    ' Check if there are conditions
    If rule.Conditions.Enabled Then
        Dim i As Integer
        For i = 1 To rule.Conditions.Count
            If condition <> "" Then condition = condition & ", "
            condition = condition & rule.Conditions(i).Text
        Next i
    End If
    
    GetRuleConditions = condition
End Function

Function GetRuleActions(rule As Outlook.Rule) As String
    Dim action As String
    action = ""
    
    ' Check if there are actions
    If rule.Actions.Enabled Then
        Dim i As Integer
        For i = 1 To rule.Actions.Count
            If action <> "" Then action = action & ", "
            action = action & rule.Actions(i).ActionType & ": " & rule.Actions(i).Text
        Next i
    End If
    
    GetRuleActions = action
End Function
